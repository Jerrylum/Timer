"use strict";function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?_arrayLikeToArray(t,e):void 0}}function _iterableToArray(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var vueTimer=new Vue({el:"#thebody",mounted:function(){var t=this;i18n.addComponent(this);var e=getCookie();e.timer_mode&&("countdown"==e.timer_mode?(this.t=new CountdownTimer,this.t._totalTicks=Math.trunc(e.timer_total_ticks)||0):(this.t=new StopwatchTimer,this.t._initTicks=Math.trunc(e.timer_init_ticks)||0),this.t._startTick=Math.trunc(e.timer_start_tick)||null,this.t._previousTicks=Math.trunc(e.timer_previous_ticks)||0),setInterval(function(){t.t&&t.t.__ob__.dep.notify()},1),this.getAllEditableTimeValueFieldElm().forEach(function(e){e.addEventListener("focus",t.focusTimeValueFieldEvent,!1),e.addEventListener("blur",t.blurTimeValueFieldEvent,!1),e.addEventListener("beforeinput",t.b4changedTimeValueFieldEvent,!1),e.addEventListener("input",t.changedTimeValueFieldEvent,!1)})},data:{t:new CountdownTimer,timerEditingFlag:{hour:!1,minute:!1,second:!1,msec:!1}},watch:{"t._previousTicks":function(){this.updateTimerCookie()},"t._startTick":function(){this.updateTimerCookie()},"t.status":function(t){vuePanel.sound.updateStatus(t)},timeS:function(){document.title="".concat(this.timeH,":").concat(this.timeM,":").concat(this.timeS)},isEditable:{handler:function(t){this.getAllEditableTimeValueFieldElm().forEach(function(e){t?e.setAttribute("contenteditable","true"):e.removeAttribute("contenteditable")})},immediate:!0}},methods:{BodyKeyDownEvent:function(t){var e=_toConsumableArray(this.getAllEditableTimeValueFieldElm());if(("Tab"===t.key||"Enter"===t.key)&&e.includes(t.target)){t.preventDefault();var i=t.target,n=e[(e.indexOf(t.target)+1)%e.length];i.blur(),n.focus()}},clickBtn1Event:function(){if(this.t.status==TimerStatus.INIT){if(0==this.t.displayTicks)this.t=new StopwatchTimer;else{var t=this.t.displayTicks;this.t=new CountdownTimer,this.t.set(t)}this.t.start()}else this.t.status==TimerStatus.RUNNING?this.t.stop():this.t.status==TimerStatus.PAUSE&&this.t.start()},clickBtn2Event:function(){this.t.status==TimerStatus.INIT?(this.t.set(0),this.updateTimerCookie()):this.t.reset()},updateEditableDataAndHtml:function(t,e){e=Math.max(0,Math.min(e,{hour:99,minute:59,second:59,msec:999}[t.id])),t.innerText=e;var i=this.getTimerData(),n=i.hour,r=i.minute,a=i.second,s=i.msec;this.t.set(n,r,a,s)},focusTimeValueFieldEvent:function(t){var e=t.target;this.timerEditingFlag[e.id]=!0,e.beforeFocus=e.innerText},blurTimeValueFieldEvent:function(t){var e=t.target,i=e.innerText,n=Math.trunc(i);this.timerEditingFlag[e.id]=!1,(0==i.length||isNaN(n)||-1!==i.indexOf("."))&&(n=Math.trunc(e.beforeFocus)),this.updateEditableDataAndHtml(e,n)},b4changedTimeValueFieldEvent:function(t){t.target.beforeInput=t.target.innerText},changedTimeValueFieldEvent:function(t){var e=window.getSelection(),i=e.getRangeAt(0).startOffset,n=t.target,r=n.innerText;0==r.length&&(r=n.innerText="0"),r=r.slice(0,"msec"==n.id?3:2);var a=Math.trunc(r);(isNaN(a)||-1!==r.indexOf("."))&&(a=Math.trunc(n.beforeInput)),this.updateEditableDataAndHtml(n,a);var s=document.createRange();s.setStart(n.childNodes[0],Math.min(n.innerText.length,i)),s.collapse(!0),e.removeAllRanges(),e.addRange(s)},updateTimerCookie:function(){setCookie({timer_mode:this.t instanceof CountdownTimer?"countdown":"stopwatch",timer_start_tick:this.t._startTick,timer_previous_ticks:this.t._previousTicks,timer_init_ticks:this.t._initTicks,timer_total_ticks:this.t._totalTicks})},getTimerData:function(){var t={};return this.getAllEditableTimeValueFieldElm().forEach(function(e){return t[e.id]=e.innerText-0}),t},getAllEditableTimeValueFieldElm:function(){return _toConsumableArray(document.querySelectorAll("#timer-body span.editable-field"))}},computed:{displayTicks:function(){return t.displayTicks},timeH:function(){if(this.timerEditingFlag.hour)return"";var t=Math.trunc(this.t.displayTicks/36e5);return(t%=100)>9?t+"":"0"+t},timeM:function(){if(this.timerEditingFlag.minute)return"";var t=Math.trunc(this.t.displayTicks%36e5/6e4);return t>9?t+"":"0"+t},timeS:function(){if(this.timerEditingFlag.second)return"";var t=Math.trunc(this.t.displayTicks%6e4/1e3);return t>9?t+"":"0"+t},timeMS:function(){if(this.timerEditingFlag.msec)return"";var t=Math.trunc(this.t.displayTicks%1e3);return this.t.status==TimerStatus.INIT&&0==t?"000":t},isBtn1Disabled:function(){return this.t instanceof CountdownTimer&&this.t.status==TimerStatus.TIMESUP},btn1Warning:function(){return this.t.status==TimerStatus.TIMESUP?lang.times_up_blocked_warning:""},btn1Message:function(){return this.t.status==TimerStatus.RUNNING?lang.pause:lang.start},btn2Message:function(){return this.t.status==TimerStatus.INIT?lang.clear:lang.reset},isEditable:function(){return this.t.status==TimerStatus.INIT||this.t.status==TimerStatus.PAUSE}}});